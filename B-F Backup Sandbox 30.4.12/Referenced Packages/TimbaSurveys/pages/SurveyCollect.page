<apex:page sidebar="false" controller="TIMBASURVEYS.SurveyCollectController" tabstyle="Timba_Surveys__tab" showheader="true" standardstylesheets="false">

    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__SurveyResources, 'inc/css/SurveyCollect.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__SurveyResources2, 'css/collector.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__SurveyResources2, 'css/analyzer_questions_section.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__SurveyResources2, 'css/navigation_survey_analyzer.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__SurveyResources2, 'css/tabsDisplay.css')}" />
    
	<!-- Add Date Picker Resources -->
    <apex:includeScript value="{!URLFOR($Resource.TIMBASURVEYS__jqTransform, 'required/jquery-1.4.2.min.js')}" />
    <apex:includeScript value="{!URLFOR($Resource.TIMBASURVEYS__Datepicker, 'jquery.datePicker.min-2.1.2.js')}" />
    <script type="text/javascript" src="{!URLFOR($Resource.jqTransform, 'jqtransformplugin/jquery.jqtransform.js')}" ></script>
    <script type="text/javascript" src="{!URLFOR($Resource.Datepicker, 'date.js')}" ></script>

    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__Datepicker, 'datePicker.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TIMBASURVEYS__jqTransform, 'jqtransformplugin/jqtransform.css')}" />

	
    <apex:include pageName="TIMBASURVEYS__TimbaSurveyStyles" />


    <style type="text/css">
    	.noDisplay{
    		display: none;
    	}
		.dateSelectorWrapper {
		    width: 260px;
		    position: relative;
		    float: left;
		    background-color: #EFF5FB;
		    border-radius: 5px 5px 5px 5px;
		    color: #2C98C5;
		    font-size: 11px;
		    padding: 8px 2px 12px 14px;
		}
		.dateSelectorMaincontainer {
			display: none;
			height: 70px;
			padding: 8px 2px 12px 14px;
		}
        .dateortime .jqTransformInputWrapper {
            width:110px !important;
        }
        .dateortime a.dp-choose-date{
            background: url('{!URLFOR($Resource.SurveyPublicResources, '/img/calendar.png')}') right no-repeat;
            background-repeat:no-repeat;
            position:absolute;
            top:0px;
            left:110px;
            width:24px;
            height:24px;
            overflow:visible;
            margin-left:3px;
            text-indent:-9999px;
            display:block;
        }
    	.dp-popup h2 {
    		display: block !important;
    	}

		ol li,ul li {
			line-height: 1.3;
			margin-left: 0;
		}

		.container a img {
			margin: 1px 0 0;
			padding: 0 5px 0 0;
			width: 18px;
		}

		.pageContent {
			padding: 0px;
		}

		#tabPanel ul li.selected img {
			margin: 1px 0 0;
			padding: 0 5px 0 0;
			width: 18px;
		}

		#email_notifications_div {
			-moz-border-radius: 5px 5px 5px 5px;
			background-color: #EFF5FB;
			color: #2C98C5;
			font-size: 11px;
			padding: 8px 2px 12px 14px;
			width: 356px;
		}

		#email_notifications_div input {
			margin: 8px 0 0 1px;
			padding: 0 1px 2px 4px;
		}

		#bodyTable #tabPanel ul li {
			width: 107px;
		}

		#mail_error {
			color: red;
			font-size: 10px;
			margin-top: 6px;
		}

		#Create_Leads {
			-moz-border-radius: 5px 5px 5px 5px;
			background-color: #EFF5FB;
			color: #2C98C5;
			font-size: 11px;
			padding: 8px 2px 12px 14px;
			width: 356px;
		}

		#Create_Leads div {
			position: absolute;
		}

		#Create_Leads a {
			margin: 0 0 0 332px;
			position: absolute;
		}

		#Create_Leads input {
			margin: 22px 5px 0 6px;
		}

		.theIframe {
			border: none;
			overflow: hidden;
			overflow-x: hidden;
			overflow-y: hidden;
		}

		#cancelButton {
			padding: 3px 3px 0;
		}

		#doneButton {
			float: right;
			padding: 3px 3px 0;
		}

		.collectabe .contCollect .contCollectHead .clear .clearImg {
			width: 10px;
			padding-bottom:2px;
			vertical-align:middle;
		}

		#Anonymous_Collection {
			-moz-border-radius: 5px 5px 5px 5px;
			background-color: #EFF5FB;
			color: #2C98C5;
			font-size: 11px;
			padding: 8px 2px 12px 14px;
			width: 356px;
			min-height: 34px;
		}

		#Anonymous_Collection a {
			font-size: 10px;
			font-weight: bold;
			margin: 4px 0 0;
			position: absolute;
			text-decoration: none;
		}

		#Anonymous_Collection input {
			background-color: #EEEEEE;
			border: 1px solid #AAC9D3;
			color: #2C98C5;
			font-family: arial;
			font-size: 12px;
			margin: 24px 0 0 2px;
			padding: 2px 5px;
			text-decoration: none;
		}

		.back {
			background-color: #FFFFFF;
			-moz-border-radius-bottomleft: 5px;
			-moz-border-radius-bottomright: 5px;
		}

		.save {
			-moz-border-radius: 4px 4px 4px 4px;
			background-color: #EFEFEF;
			float: left;
			height: 30px;
			text-decoration: none;
			width: 120px;
		}

		body .tabNavigation .tab .allTabsArrow {
			width: 7px;
		}

		.surveyButton img {
			width:18px;
		}
		#response a {
			color: #47A3CC;
			font-size: 10px;
			margin: -20px -16px 0;
			position: absolute;
			text-decoration: none;
		}

		#response div {
			margin: 14px 0 0 148px;
			position: absolute;
		}

		#response img {
			margin: 15px 0 0 119px;
			position: absolute;
		}

		#tabPanel img {
			margin: 2px 5px 0 0;
			width: 18px;
		}

		#response:hover {
				/*text-decoration: underline;*/
			/*text-decoration: underline;*/
		}

		.iframeHide {
			display: none;
		}

		.collectabe {
			height: auto;
			padding-bottom: 14px;
		}

		.ErrorCollect {
			color: red;
			font-size: 12px;
			margin: 8px 0 3px 42px;
		}

		#errorEmailsButton {
			background-color: #EEEEEE;
			border: 1px solid #AAC9D3;
			color: #2C98C5;
			font-family: arial;
			font-size: 10px;
			padding: 5px 10px;
			text-decoration: none;
		}

		#errorEmailDiv {
			height: 230px;
			overflow-x: hidden;
			overflow-y: auto;
			width: 331px;
		}

		#sendButton {
			float:right;
			height:32px;
		}

		.radio {
			margin: 5px 7px 8px 6px;
		}

		#pageContainer_html {
			overflow: hidden;
		}

		.listCollect img {
			width: 29px
		}

		#surveymodeCollection .dijitDialogPaneContent{
			width:900px !important;
			overflow-y:auto !important;
		}

		.close img {
			width: auto;
		}

		.addedContactSend {
			background-color: #EFF9FC;
		}

		.closeSend {
			display: none;
		}

		#progresBar {
			width: 278px;
		}

		#progresBar img {
			float: left;
		}

		#bar {
			-moz-border-radius: 3px 3px 3px 3px;
			background-color: #2790C1;
			float: right;
			height: 13px;
			margin: -16px 64px 0 0;
			position: relative;
			width: 208px;
		}

		#dataProgres {
			color: #5999E9;
			font-size: 11px;
			font-weight: bold;
			margin: 26px 0 0;
			position: relative;
			text-align: center;
		}

		#titleSend {
			color: #2790C1;
			font-size: 14px;
			font-weight: bold;
			margin-bottom: 4px;
			text-align: center;
		}

		#progresSendEmails .dijitDialogCloseIcon {
			display: none;
		}

		#emailTemplateError .dijitDialogCloseIcon {
			display: none;
		}

		.email_template_missing_message {
			color: #1F9ECD;
			font-size: 13px;
			font-weight: bold;
			margin: 20px;
			text-align: center;
			width: 300px;
		}

		#cp_reset {
			font-size: 15px;
			padding: 6px 8px 5px 10px;
			text-align: center;
		}

		#reset {
			font-size: 15px;
			padding: 6px 8px 5px 10px;
			text-align: center;
		}

		#recreate {
			font-size: 15px;
			padding: 6px 8px 5px 10px;
			text-align: center;
		}
		#CPortalContact{
			background-color:#F7F9FF;
			padding:6px 6px 6px 25px;
			position:relative;
			margin:5px 0 9px;
		}
		#CPortalContact label{
			font-weight:bold;
		}

		.close{
			float:right;
			padding-right:8px;
			padding-top:13px;
		}
	  	#salvedMessage{}
	  	#salvedMessage div{
			color:#47A3CC;
			font-family:arial;
			font-size:12px;
			font-weight:bold;
			text-align:center;

	  	}
	  	#salvedMessage label{
			color:#2C98C5;
			font-size:16px;
			font-weight:bold;
	  	}
	  	#salvedMessage #salvedText{
	  		float:left;
			margin:4px 0 7px;
	  	}
	  	#salvedMessage #cont{
	  		color:black;
			float:left;
			font-size:12px;
			margin:4px 0 7px 10px;
	  	}
	  	#radio2{
	  		margin:-21px 0 0 25px;
	  	}
	  	#radio3{
	  		margin:-22px 0 0 25px;
	  	}

	  	#more_{
	  		height:30px;
			text-align:center;
	  	}
	  	#more_Text{
	  		font-size:12px;
			font-weight:bold;
			margin-top:6px;
			text-align:center;
		}
		a{
			color:#2C98C5;
			text-decoration:none;
		}
	  	#more_Img img{
	  		margin-top:6px;
			width:21px;
	  	}
	  	li{
	  		list-style:none;
	  	}

	  	#tableEmailErrorLeadContact td{
	  		border-bottom:1px solid #2C9DC8;
			font-family:monospace;
			font-size:13px;
			font-weight:bold;
			padding:3px 12px 0 14px;
			text-align:center;
	  	}

	  	#tableErrorDuplicated{
	  		margin-left:29px;
	  	}

	  	#tableErrorDuplicated  td{
	  		border-bottom:1px solid #2C9DC8;
			font-family:monospace;
			font-size:13px;
			font-weight:bold;
			padding:3px 12px 0 14px;
			text-align:center;
	  	}

	  	#errorLeadContactDiv{
	  		width:300;
			height:140px;
			overflow-y:auto;
			overflow-x:hidden;
	  	}

	  	#errorDuplicatedDiv{
	  		width:300;
			height:140px;
			overflow-y:auto;
			overflow-x:hidden;
	  	}

		/*. {
			font-family: Arial,Helvetica,sans-serif;
			font-size: 13px;
			color: #11799f;
			background-color: #f1f1f1;
			border: 1px #8ec1b0 solid;

			padding: 2px;
			text-decoration: none;

			-webkit-border-top-left-radius: 4px;
			-webkit-border-top-right-radius: 4px;
			-moz-border-radius-topleft: 4px;
			-moz-border-radius-topright: 4px;
			border-top-left-radius: 4px;
			border-top-right-radius: 4px;
		}*/
	</style>

     <apex:composition template="TIMBASURVEYS__timbaSurveysTemplate">
    	<!-- customJs Imports & Script Tags -->
		<apex:define name="customJs">
			<!-- DOJO Framework -->
			<script type="text/javascript" src="{!URLFOR($Resource.timbasurveys_dojo_build, 'dijit/dijit.js')}"></script>
	    	<script type="text/javascript" src="{!URLFOR($Resource.timbasurveys_dojo_build, 'dijit/dijit-ui.js')}"></script>
			<script type="text/javascript" src="{!URLFOR($Resource.timbasurveys_dojo_build, 'dijit/dijit-form.js')}"></script>
			<script type="text/javascript" src="{!URLFOR($Resource.timbasurveys_dojo_build, 'dojox/dojox-widgets.js')}"></script>
  			<script type="text/javascript" src="{!URLFOR($Resource.SurveyResources2, 'js/list.js')}"></script>
  			<apex:include pageName="TIMBASURVEYS__SurveyCollectDataJs" />
			<apex:include pageName="TIMBASURVEYS__SurveyCollectEmailsJs" />
		</apex:define>
	
	<!-- BreadCrumb -->
    <apex:define name="breadCrumb">
    	<c:timbaSurveysBreadCrumb steps="{!$Label.timbasurveys__timbasurveys_Survey_List}:::{!$Page.TIMBASURVEYS__SurveyList},,,{!CurrentSurvey.name}"/>
	</apex:define>

	<!-- Body Section -->
	<apex:define name="body">
	      <apex:outputPanel styleClass="tabSet" layout="block">
			<apex:outputLink value="{!$Page.TIMBASURVEYS__SurveyOverview}" styleClass="tabElem">
				<apex:param name="id" value="{!SurveyId}"/>
				<apex:outputText value="{!$Label.timbasurveys__timbasurveys_tabs_overview}" />
			</apex:outputLink>
			<apex:outputpanel layout="none" rendered="{!$ObjectType.TIMBASURVEYS__Survey__c.updateable}">
				<apex:outputLink value="{!$Page.TIMBASURVEYS__SurveyPreview}" styleClass="tabElem">
					<apex:param name="id" value="{!SurveyId}" />
					<apex:param name="prev" value="true" />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_tabs_design}" />
				</apex:outputLink>
				<apex:outputLink value="{!$Page.TIMBASURVEYS__SurveyCollect}" styleClass="tabElem imIn">
					<apex:param name="id" value="{!SurveyId}" />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_tabs_collect}" />
				</apex:outputLink>
			</apex:outputpanel>
            <apex:outputpanel layout="none" rendered="{!if(CurrentSurvey.TIMBASURVEYS__CollectedResponses__c == 0 , false, true)}">
				<apex:outputLink value="{!$Page.TIMBASURVEYS__SurveyAnalyze}" styleClass="tabElem">
					<apex:param name="id" value="{!SurveyId}" />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_tabs_analize}" />
				</apex:outputLink>
			</apex:outputpanel>
			<div class="marginInf"></div>
		</apex:outputPanel>

		<div class="banner">
			<button id="sendButton" class="leftContainer surveyButton" onclick="ShowSendEmailsOverlay();"><img alt="Send" src="{!URLFOR($Resource.SurveyResources2,'img/collector/mail_send.png')}"/>{!$Label.timbasurvey_surveyCollect_Send}</button>
		</div>

		<div class="back" id="dataContainerMaster">
				<apex:outputPanel layout="block" styleClass="brothers" id="brothersWrapper">
		            <div id="collectionParameters" class="container">
		                <apex:outputPanel styleClass="fieldTitleA">
		                    <apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Collection_Parameters}" />
		                </apex:outputPanel>
		                <apex:outputPanel styleClass="fieldTitleB">
		                    <apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_General}" id="textFieldTitleB" />
		                </apex:outputPanel>

		                <div class="fieldTitle">
		                    <div class="content"><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Created_On}:" id="contentTitle" /></div>
		                    <div class="content"><span>&nbsp;<apex:outputText value="{!MONTH(CurrentSurvey.CreatedDate)}" />/<apex:outputText value="{!DAY(CurrentSurvey.CreatedDate)}" />/<apex:outputText value="{!YEAR(CurrentSurvey.CreatedDate)}" /> </span></div>
		                </div>

						<div id="response" class="fieldTitle">
							<apex:outputText styleClass="content" value="{!$Label.timbasurveys__timbasurveys_surveycollect_Responses}:" />
							<span id="responsed" class="content">
								<apex:outputPanel id="responsesCount" layout="inline" >
									<apex:outputText value="{!ROUND(CurrentSurvey.TIMBASURVEYS__CollectedResponses__c,0)}" />
								</apex:outputPanel>
								<apex:outputpanel layout="none" rendered="{!If(CurrentSurvey.TIMBASURVEYS__CollectedResponses__c == 0 , false, true)}">
									<apex:outputLink value="{!$Page.TIMBASURVEYS__SurveyAnalyze}">
										<apex:param name="id" value="{!SurveyId}" />
										<apex:image value="{!URLFOR($Resource.TIMBASURVEYS__SurveyResources2,'img/collector/big_piechart.png')}" title="{!$Label.timbasurveys__timbasurveys_surveycollect_Results}" alt="{!$Label.timbasurveys__timbasurveys_surveycollect_Results}"/>
										<apex:outputPanel layout="block">
											<apex:outputText value="{!$Label.timbasurveys__timbasurveys_tabs_analize}" />
											<br/>
											<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Results}" />
										</apex:outputPanel>
									</apex:outputLink>
								</apex:outputpanel>
							</span>
						</div>

						<apex:form >
							<apex:actionFunction name="responsesUpdate" action="{!Util.updateResponsesCount}" rerender="responsesCount" />
						</apex:form>

		                <apex:outputPanel styleClass="fieldTitleB" layout="block">
		                    <apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Collection_Settings}" id="collectionSettingsTxt" />
		                </apex:outputPanel>

		                <div class="fieldTitle clearb">
		                    <div class="content"><span>{!$Label.timbasurveys_surveycollect_Collection}:</span></div>
		                    <div class="content"><a id="collectionSwitch" class="switch {!IF(Util.CurrentSurvey.CollectingData__c,'on','')}" href="javascript:;" onclick="OnOffOverlay.show(); setCollection(this);" >switch_collection</a></div>
		                </div>

		                <div class="fieldTitle clearb">
		                    <div class="content"><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Anonymous_Collection}:" id="AnonymousCollectionTxt" /></div>
		                    <div class="content" ><a id="anonymousSwitch" class="switch {!IF(CurrentSurvey.AllowAnonymousRecipients__c,'on','')}" href="javascript:;" onclick="OnOffOverlay.show(); setAnonymous(this);" >switch_anonymous_collection</a></div>
		                	<div id="Anonymous_Collection" class="content" style="{!IF(CurrentSurvey.AllowAnonymousRecipients__c,'','display:none;')}">
		                		<div><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Current_Survey_link}:"/></div>
			                		<apex:outputLink value="{!AnonymousSurveyLink}" target="_blank" id="anonymus_Link">
			                			<apex:outputText value="{!AnonymousSurveyLinkCut}" />
			                		</apex:outputLink>
									<div id='buttonCopyAnonymous' style="border:solid 1px black; width:60px; height:20px;margin:23px 0 -6px -1px;">
									</div>
									<!-- CHATTER POSTING -->
									<apex:outputPanel id="chatter_feed" rendered="{!chatterEnabled}">
										<div id="Chatter_Switcher" class="fieldTitle clearb" style="display:{!IF(CurrentSurvey.AllowAnonymousRecipients__c,'','none')}">
						                	<div class="content"><apex:outputText value="{!$Label.timbasurveys__timabasurveys_Collector_Chatter}:" id="chatterTxt"/></div>
					                    	<div class="content">
					                    		<input type="button" title="Share" onclick="sendByChatterSurvey('on');" name="publishersharebutton" id="publishersharebutton" class="btnPrimary publishersharebutton btn" style="margin-top: 0px;color: #FFFFFF;" value="{!$Label.timbasurveys_Collector_Share}" />
					                    		<span id="chatterSent" style="float:right; display:none"></span>
					                    	</div>
						                </div>
				                </apex:outputPanel>
		                	</div>
		                </div>
		                <div class="fieldTitle clearb">
		                    <div class="content"><apex:outputText id="allowMultiplesTxt" value="{!$Label.timbasurveys__timbasurveys_surveycollect_Allow_multiples}:" /></div>
		                    <div class="content"><a id="multiFillSwitch" class="switch {!IF(CurrentSurvey.AllowMultiFill__c,'on','')}" href="javascript:;" onclick="OnOffOverlay.show(); setMulfiFill(this);" >switch_allow_multiple_responses</a></div>
		                </div>
		                <div class="fieldTitle clearb">
		                    <div class="content"><span>{!$Label.timbasurveys_surveycollect_Enable_Notifications}:</span></div>
		                    <div class="content"><a id="emailNotificationSwitch" class="switch {!IF(CurrentSurvey.NotifyResponses__c,'on','')}" href="javascript:;" onclick="show_email_notifications(this);" >switch_enable_notifications</a></div>
		               		<div id="email_notifications_div" class="content" style="{!IF(CurrentSurvey.NotifyResponses__c,'','display:none;')}">
		               			<apex:outputPanel id="sendNotificationcontainer" layout="block">
		               				<apex:outputText value="{!$Label.timbasurveys__timbasurveys_Collector_Send_email_notification}:" />
		               			</apex:outputPanel>
		               			<input value="{!CurrentSurvey.NotificationEmail__c}" type="text" id="email_notifications" onblur="validateMail(this);"/>
		               			<div id='mail_error'></div>
		               		</div>
		                </div>

						<apex:outputPanel layout="block" styleClass="fieldTitle clearb" id="expirationDate">
							<apex:outputPanel layout="block" styleClass="content">
								<apex:outputText id="enableExpirationDateLabelTxt" value="{!$Label.timbasurveys__timbasurveys_surveycollect_Enable_Expiration_Date}:" />
							</apex:outputPanel>
							<apex:outputPanel layout="block" styleClass="content">
								<apex:outputLink id="outPutexpired" styleClass="switch {!if(CurrentSurvey.TIMBASURVEYS__Expiration_Date_Enabled__c,'on','')}" value="javascript:;" onClick="onOfExpirationDate(this);" >
									<span class="noDisplay" id="enableExpirationDateLnkTxt">
										<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Switch_expiration_date} {!if(CurrentSurvey.TIMBASURVEYS__Expiration_Date_Enabled__c,$Label.timbasurveys__timbasurveys_off,$Label.timbasurveys__timbasurveys_on)}" />
									</span>
								</apex:outputLink>
							</apex:outputPanel>

							<div class="dateSelectorMaincontainer" style="display:{!IF(CurrentSurvey.TIMBASURVEYS__Expiration_Date_Enabled__c,'block','none')}">
							<apex:outputPanel styleClass="dateSelectorWrapper" layout="block">
					            <apex:outputPanel styleClass="dateortime" layout="block" style="width: 160px; position: relative; display: block;">
					            	<apex:outputPanel styleClass="jqTransformInputWrapper" layout="block">
					            		<apex:outputPanel styleClass="jqTransformInputInner" layout="block">
					            			<input class="datepicker" id="expirationDateInput" type="text" maxlength="70" value="{!YEAR(CurrentSurvey.Expiration_Date__c)}-{!if(MONTH(CurrentSurvey.Expiration_Date__c) > 9, '', '0')}{!MONTH(CurrentSurvey.Expiration_Date__c)}-{!DAY(CurrentSurvey.Expiration_Date__c)}" />
					            		</apex:outputPanel>
					            	</apex:outputPanel>
					            </apex:outputPanel>
							</apex:outputPanel>
						</div>
						</apex:outputPanel>
						<script type="text/javascript">
							if ({!CurrentSurvey.Expiration_Date_Enabled__c}){
								jQuery('.dateSelectorMaincontainer').show();
								var tmpDate = new Date();
								var currentYear = tmpDate.getFullYear();
								var currentMonth = tmpDate.getMonth() + 1;
								var currentDay = tmpDate.getDate();
								var startDate = currentYear + '-' + currentMonth + '-' + currentDay;
								jQuery(function(){
							    	Date.format = 'yyyy-mm-dd';
							    	jQuery('.datepicker').datePicker({
							            	clickInput:true,
							            	startDate: startDate
							        	})
							        	.dpSetOffset(25, -5);
								});
								// 	when input value changes, submit information to controller
								jQuery('#expirationDateInput').change(function() {
									if ( wrongDate( jQuery('#expirationDateInput').val() ) ) StartDateGraterDialog.show();
									else{
										OnOffOverlay.show();
										surveyExpirationDate(true,jQuery('#expirationDateInput').val());
									}
								});
							}
						</script>

		                <div class="fieldTitle clearb">
		                    <div class="content"><span>{!$Label.timbasurveys_surveycollect_Create_Leads_from}:</span></div>
		                    <div class="content"><a class="switch {!IF(CurrentSurvey.CreateLeads__c,'on','')}" href="javascript:;" onclick="OnOffOverlay.show(); saveLeadCatching(this);">switch_create_recipients</a></div>
		                	<div id="Create_Leads" class="content" style="{!IF(CurrentSurvey.CreateLeads__c,'','display:none;')}">
		                		<div><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Create_Leads}" /></div>
		                		<a title=" {!$Label.timbasurveys_surveycollect_if_create}" ><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/info.png')}" /></a>
								<apex:outputPanel layout="none" rendered="{!CurrentSurvey.TIMBASURVEYS__RequireLeads__c}">
									<input type="checkbox" onclick= "CreateLavels();" id="required_lead_data" checked="checked"/> {!$Label.timbasurveys_surveycollect_the_info}
								</apex:outputPanel>
								<apex:outputPanel layout="none" rendered="{!NOT(CurrentSurvey.TIMBASURVEYS__RequireLeads__c)}">
									<input type="checkbox" onclick= "CreateLavels();" id="required_lead_data" /> {!$Label.timbasurveys_surveycollect_the_info}
								</apex:outputPanel>
		                	</div>
			                <div class="fieldTitleB">
			                    <apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_email_template}" id="fieldTitleBTxt" />
			                </div>
			                <div>
			                   <button  class="surveyButton" onClick="etampalte();" ><img alt="" class="customimg" src="{!URLFOR($Resource.SurveyResources2, 'img/collector/custom.png')}"/>{!$Label.timbasurveys_surveycollect_customize_email}</button>
			                </div>
			            </div>
		            </div>
					<div class="separador"></div>
				<div class="collectabe">
						<div class="titleC">
							<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Recipients}" />
						</div>
						<div class="contCollect" id="contCollectRecipient">
							<div class="contCollectHead">
								<apex:outputPanel styleClass="cantidad" layout="block">
									<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Total_Recipients}:" />
								</apex:outputPanel>
								<div id="numTot" class="number"></div>
								<button id="clearBTN" class="clearBTN" onclick="clearAll();"><img class="clearImg" style="padding-bottom:2px; vertical-align:middle;" src="{!URLFOR($Resource.SurveyResources2,'img/collector/trashcan.png')}"/>
									<apex:outputText styleClass="clearText" value="{!$Label.timbasurveys__timbasurveys_surveycollect_Clear_Not_Sent}" />
								</button>
							</div>
							<div class="contCollectCont">
								<ul id="ul_collect" class="listCollect">
									  <apex:repeat value="{!Recipient_list}" var="item">
									  	<li title ="{!item.Type_C}" class="{!if(item.Collected,'collected',if(item.Invitation,'waiting','addedContact'))}" id="{!item.Id}">
									  		<div class="imgS">
									  			<img src="{!IF(item.styleClass == 'EmailSalved', URLFOR($Resource.SurveyResources2, 'img/collector/mail_big.png'), '')}{!IF(item.styleClass == 'EmailInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/mail-pending.png'), '')}{!IF(item.styleClass == 'EmailCollect', URLFOR($Resource.SurveyResources2, 'img/collector/mail-received.png'), '')}{!IF(item.styleClass == 'LeadCollect', URLFOR($Resource.SurveyResources2, 'img/collector/lead-received.png'), '')}{!IF(item.styleClass == 'LeadInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/lead-pending.png'), '')}{!IF(item.styleClass == 'LeadSalved', URLFOR($Resource.SurveyResources2, 'img/collector/lead_big.png'), '')}{!IF(item.styleClass == 'ContactCollect', URLFOR($Resource.SurveyResources2, 'img/collector/contacticon_collected_big.png'), '')}{!IF(item.styleClass == 'ContactInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/contacticon_waiting_big.png'), '')}{!IF(item.styleClass == 'ContactSalved', URLFOR($Resource.SurveyResources2, 'img/collector/contacticon_big.png'), '')}{!IF(item.styleClass == 'UserCollect', URLFOR($Resource.SurveyResources2, 'img/collector/users-received.png'), '')}{!IF(item.styleClass == 'UserInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/users-pending.png'), '')}{!IF(item.styleClass == 'UserSalved', URLFOR($Resource.SurveyResources2, 'img/collector/usersicon_big.png'), '')}" />
									  		</div>
									  		<div class="textS">
									  			<div class="nomP"><apex:outputText value="{!if(LEN(item.Name) > 17, LEFT(item.Name,17) & '...', item.Name)}" /></div>
									  			<div class="nomE"><apex:outputText value="{!if(LEN(item.Email) > 22, LEFT(item.Email,22) & '...', item.Email)}" /></div>

									  		</div>

									  		<apex:outputPanel layout="none" rendered="{!IF(item.Invitation && !item.Collected,true,false)}">
									  			<div class="waitingText">{!$Label.timbasurveys__timbasurveys_surveycollect_not_completed}</div>
									  		</apex:outputPanel>
									  		<apex:outputPanel layout="none" rendered="{!IF(item.Collected,true,false)}">
									  			<apex:outputPanel layout="none" rendered="{!IF(item.SurveySummary!=null,true,false)}">
									  			<!--  	<div class="viewReply"><a class="textContent" href="SurveySummary?id={!item.SurveySummary}" >{!$Label.timbasurveys__timbasurveys_surveycollect_View_Reply} </a></div> -->
									  			<div class="viewReply"><a class="textContent" href="SurveySummary?id={!item.SurveySummary}" >&nbsp;{!$Label.timbasurveys__timbasurveys_surveycollect_View_Reply}&nbsp;</a></div>

									  			</apex:outputPanel>
									  			<apex:outputPanel layout="none" rendered="{!IF(item.SurveySummary==null,true,false)}">
									  				<div class="viewReply"><div>{!$Label.timbasurveys__timbasurveys_surveycollect_Multiples} <br/>{!$Label.timbasurveys__timbasurveys_surveycollect_Responses} </div></div>
									  			</apex:outputPanel>
									  		</apex:outputPanel>

									  		<apex:outputPanel layout="none" rendered="{!if(item.Collected,false,if(item.Invitation,false,true))}">
												<div class="remuve_Recipcient" id="{!item.Id}" style="display:none;"></div>
									  			<div class="close"><a href="javascript:;" class="remove" onclick="remove_recipient('{!JSENCODE(item.Id)}','{!JSENCODE(item.Type_c)}','{!item.Collected}');"><img border="0" class="closeImg" src="{!URLFOR($Resource.SurveyResources2, 'img/icons/gray_cross.png')}" /></a></div>
									  		</apex:outputPanel>

										    <apex:outputPanel layout="none" rendered="{!IF(item.Type_C!='User' && item.Type_C!='Email',true,false)}">
									  			<a class="viewReply2" href="javascript:;"  onclick="fill_survey('{!JSENCODE(item.Id)}','{!JSENCODE(item.Type_c)}');"><img border="0" id="A{!item.Id}" onmouseover="sizeImg('A{!item.Id}')" onmouseout="sizeImge('A{!item.Id}')" width="10" height="25" src="{!URLFOR($Resource.SurveyResources2, 'img/collector/fill_survey.PNG')}" /></a>
										    </apex:outputPanel>
										</li>

							  		 </apex:repeat>
										   <li id="more_" style="{!if(Recipient_CollectorController.renderNext,'','display:none')};" >
										  		<div id="more_Text" onclick="paginationNext_more();"><a href="javascript:;">{!$Label.timbasurveys_surveycollect_VIEW_MORE}</a></div>
										  		<div id="more_Img" style='display:none;'><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/remove_loading.gif')}"/></div>
						  				   </li>
									</ul>
								</div>
									<apex:form style="display:none;" >
										<apex:outputPanel layout="block" id="list_collect">
											<ul id="ul_Hide" class="listCollect">
											  <apex:repeat value="{!Recipient_list}" var="item" >
												  <li title ="{!item.Type_C}" class="{!if(item.Collected,'collected',if(item.Invitation,'waiting','addedContact'))}" id="{!item.Id}">
											  		<div class="imgS">
											  			<img src="{!IF(item.styleClass == 'EmailSalved', URLFOR($Resource.SurveyResources2, 'img/collector/mail_big.png'), '')}{!IF(item.styleClass == 'EmailInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/mail-pending.png'), '')}{!IF(item.styleClass == 'EmailCollect', URLFOR($Resource.SurveyResources2, 'img/collector/mail-received.png'), '')}{!IF(item.styleClass == 'LeadCollect', URLFOR($Resource.SurveyResources2, 'img/collector/lead-received.png'), '')}{!IF(item.styleClass == 'LeadInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/lead-pending.png'), '')}{!IF(item.styleClass == 'LeadSalved', URLFOR($Resource.SurveyResources2, 'img/collector/lead_big.png'), '')}{!IF(item.styleClass == 'ContactCollect', URLFOR($Resource.SurveyResources2, 'img/collector/contacticon_collected_big.png'), '')}{!IF(item.styleClass == 'ContactInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/contacticon_waiting_big.png'), '')}{!IF(item.styleClass == 'ContactSalved', URLFOR($Resource.SurveyResources2, 'img/collector/contacticon_big.png'), '')}{!IF(item.styleClass == 'UserCollect', URLFOR($Resource.SurveyResources2, 'img/collector/users-received.png'), '')}{!IF(item.styleClass == 'UserInvitation', URLFOR($Resource.SurveyResources2, 'img/collector/users-pending.png'), '')}{!IF(item.styleClass == 'UserSalved', URLFOR($Resource.SurveyResources2, 'img/collector/usersicon_big.png'), '')}" />
											  		</div>
											  		<div class="textS">
											  			<div class="nomP"><apex:outputText value="{!if(LEN(item.Name) > 17, LEFT(item.Name,17) & '...', item.Name)}" /></div>
											  			<div class="nomE"><apex:outputText value="{!if(LEN(item.Email) > 22, LEFT(item.Email,22) & '...', item.Email)}" /></div>
											  		</div>
											  		<apex:outputPanel layout="none" rendered="{!IF(item.Invitation && !item.Collected,true,false)}">
											  			<div class="waitingText"><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_not_completed}" /></div>
											  		</apex:outputPanel>
											  		<apex:outputPanel layout="none" rendered="{!IF(item.Collected,true,false)}">
											  			<apex:outputPanel layout="none" rendered="{!IF(item.SurveySummary!=null,true,false)}">
											  				<apex:outputPanel layout="block" styleClass="viewReply">
											  				<apex:outputLink styleClass="textContent"  value="{!$Page.TIMBASURVEYS__SurveySummary}">
											  					<apex:param name="id" value="{!item.SurveySummary}" />
											  					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_View_Reply}" />
											  				</apex:outputLink>
											  				</apex:outputPanel>
											  			</apex:outputPanel>
											  			<apex:outputPanel layout="none" rendered="{!IF(item.SurveySummary==null,true,false)}">
											  				<div class="viewReply"><div>{!$Label.timbasurveys__timbasurveys_surveycollect_Multiples} <br/>{!$Label.timbasurveys__timbasurveys_surveycollect_Responses}</div></div>
										  				</apex:outputPanel>
											  		</apex:outputPanel>

													<apex:outputPanel layout="none" rendered="{!if(item.Collected,false,if(item.Invitation,false,true))}">
											  			<div class="remuve_Recipcient" id="{!item.Id}" style="display:none;"></div>
											  			<div class="close"><a href="javascript:;" class="remove" onclick="remove_recipient('{!item.Id}','{!item.Type_C}', '{!item.Collected}');"><img border="0" class="closeImg" src="{!URLFOR($Resource.SurveyResources2, 'img/icons/gray_cross.png')}" /></a></div>
											  		</apex:outputPanel>

											  		<apex:outputPanel layout="none" rendered="{!IF(item.Type_C!='User' && item.Type_C!='Email',true,false)}">
											  			<a class="viewReply2" href="javascript:;"  onclick="fill_survey('{!item.Id}','{!item.Type_C}');" ><img border="0" id="A{!item.Id}" onmouseover="sizeImg('A{!item.Id}')" onmouseout="sizeImge('A{!item.Id}')" width="10" height="25" src="{!URLFOR($Resource.SurveyResources2, 'img/collector/fill_survey.PNG')}" /></a>
												    </apex:outputPanel>
												</li>
											  </apex:repeat>
											    <li id="more_" style="{!IF(Recipient_CollectorController.renderNext,'','display:none')};" >
											  		<div id="more_Text" onclick="paginationNext_more();"><a href="javascript:;">{!$Label.timbasurveys_surveycollect_VIEW_MORE}</a></div>
											  		<div id="more_Img" style='display:none;' ><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/remove_loading.gif')}"/></div>
							  				   </li>
											</ul>
											</apex:outputPanel>
										<apex:actionFunction name="paginationNext" action="{!Recipient_CollectorController.GoNext}"  onComplete="attachListCollect()" rerender="list_collect" />
										<apex:actionFunction name="paginationUpdate" action="{!getRecipientsList}"  onComplete="updateListCollect()" rerender="list_collect" />
									</apex:form>
							<div class="contCollectBottom" >
								<button  class="surveyButton" onclick="showSurveymodeCollection();">
									<img class="addRecipientsImg" src="{!URLFOR($Resource.SurveyResources2,'img/collector/add_recipient_icon.png')}"/>
									<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Add_Recipients}" />
								</button>
							</div>
						</div>

						<div id='errorEmails' class='ErrorCollect' style='display:none'><label>{!$Label.timbasurveys_surveycollect_wron_email_format}</label><br/><br/>
							<a id='errorEmailsButton' href="javascript:;" onclick="EmailsCollectorErrorDijit.show();">
								<apex:outputText styleClass="addRecipientsText" value="{!$Label.timbasurveys__timbasurveys_surveycollect_view_emails}" />
							</a>
						</div>
						<div id='errorDuplicated' class='ErrorCollect' style='display:none'><label>{!$Label.timbasurveys_surveycollect_Duplicate_ContactsUsers}.</label><br/><br/>
							<a id='errorEmailsButton' href="javascript:;" onclick="DuplicatedError.show();">
								<apex:outputText styleClass="addRecipientsText" value="{!$Label.timbasurveys__timbasurveys_surveycollect_view_emails}" />
							</a>
						</div>
						<br/>
						<div id='errorLeadContact' class='ErrorCollect' style='display:none'>
							<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_one_or_more}" /><br />
							<div id='errorLeadContactNoAccount' style='display:none'>
								<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_no_account_asigned}" /><br />
							</div>
							<div id='errorLeadContactBounced' style='display:none'>
								<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_bounced_emails}" /><br />
							</div>
							<div id='errorLeadContactMail' style='display:none'>
								<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_are_missing}" /><br />
							</div>
							<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_please_update}." />
							<br/><br/>
							<a id="errorEmailsButton" href="javascript:;" onclick="LeadContactCollectorError.show();">
								<apex:outputText styleClass="addRecipientsText" value="{!$Label.timbasurveys__timbasurveys_surveycollect_view}" />
							</a>
						</div>
					</div>
		     </apex:outputPanel>
		     <div style='clear:both;margin-top:7px;padding:9px 0 0;' ></div>
		</div>

     		<div jsId="SaveOverlay" dojoType="dojox.widget.Standby" target="dataContainerMaster" color="white"></div>
     		<div jsId="CollectionOverlay" dojoType="dojox.widget.Standby" target="surveymodeCollection" color="white"></div>
     		<div jsId="CollectionOverlayName" dojoType="dojox.widget.Standby"  id="CollectionOverlayName" target="contCollectRecipient" color="white"></div>
     		<div jsId="OnOffOverlay" dojoType="dojox.widget.Standby" target="collectionParameters" color="white"></div>

			<div id="surveymodeCollection" jsId="surveymodeCollectionDijit" dojoType="dijit.Dialog" title="{!$Label.timbasurvey_Collect_Select_Recipient}"  onCancel="closeSurveymodeCollection();"  style = 'width:921px; height:auto;'>
				<div id="bodyModalCollection" style="width: 878px; height: 530px;">
					<div id="pageContainer_html" class="pageContainer" style="width: 858px; height: 451px;">
						<!-- <Tab Panel Html> -->
						<div id="tabPanel">
							<ul>
								<li class="selected" onclick="selectEmails(this);"><a href="javascript:;"><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/emailicon.png')}"/>{!$Label.timbasurveys_surveycollect_Emails}</a></li>
								<li onclick="selectContact(this);"><a href="javascript:;"><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/contacticon.png')}"/>{!$Label.timbasurveys_surveycollect_Contacts}</a></li>
								<li onclick="selectUsers(this);"><a href="javascript:;"><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/usersicon.png')}"/>{!$Label.timbasurveys_surveycollect_Users}</a></li>
								<li onclick="selectLeads(this);"><a href="javascript:;"><img src="{!URLFOR($Resource.SurveyResources2,'img/collector/leadsicon.png')}"/>{!$Label.timbasurveys_surveycollect_Leads}</a></li>
							</ul>
						</div>
						<div class="tabFooter">&nbsp;</div>
						<!-- </Tab Panel Html> -->
						<div class="pageContent">
							<iframe id="theIframeEmail" class='theIframe' name="theIframeEmail" width="856px" height="449px" onload="loadingtheIframeEmailFin();" scrolling="no" frameborder="0"></iframe>
							<iframe id="theIframeContact"  class='theIframe' name="theIframeContact" width="856px" height="449px" onload="loadingtheIframeContacFin();" scrolling="no" frameborder="0"></iframe>
							<iframe id="theIframeUser" class='theIframe' name="theIframeUser" width="856px" height="449px" onload="loadingtheIframeUserFin();" scrolling="no" frameborder="0"></iframe>
							<iframe id="theIframeLeads" class='theIframe' name="theIframeLeads" width="856px" height="449px" onload="loadingtheIframeLeadsFin();" scrolling="no" frameborder="0"></iframe>
						</div>
					</div>
				</div>

				<button id="cancelButton" class="leftContainer surveyButton" onClick="surveymodeCollectionDijit.onCancel();" ><img alt="Cancel" src="{!URLFOR($Resource.SurveyResources2,'img/overlay/cancelicon.png')}"/>{!$Label.timbasurveys_surveycollect_Cancel}</button>
				<button id="doneButton" class="leftContainer surveyButton" onClick="LoadingDataIframe();" ><img alt="{!$Label.timbasurveys_surveycollect_Done}" src="{!URLFOR($Resource.SurveyResources2,'img/overlay/okicon.png')}"/>{!$Label.timbasurveys_surveycollect_Done}</button>

			</div>

			<div id="EmailsCollectorError" jsId="EmailsCollectorErrorDijit" dojoType="dijit.Dialog" title="{!$Label.timbasurveys_surveycollect_wron_email_format}" >
				<div id='errorEmailDiv'></div>
			</div>

			<div id="LeadContactCollectorError" jsId="LeadContactCollectorError" style='height:200px;width:450px;'  onCancel="clearErrorLeadContact();" dojoType="dijit.Dialog" title="" >
				<div id='errorLeadContactDiv'><table id='tableErrorLeadContact'></table></div>
				<a id='errorEmailsButton' href="javascript:;" onclick="clearErrorLeadContact();">
					<span class="addRecipientsText">{!$Label.timbasurveys__timbasurveys_surveycollect_Clear}</span>
				</a>
			</div>

			<div id="DuplicatedError" jsId="DuplicatedError" style='height:200px;width:350px;' dojoType="dijit.Dialog" title="" onCancel="closeShowDuplicated();">
				<div id='errorDuplicatedDiv'><table id='tableErrorDuplicated'></table></div>
			</div>


		    <div id="sendEmailsOverlay" jsId="sendEmailsOverlayDijit" dojoType="dijit.Dialog" color="white" title="{!$Label.timbasurvey_Collect_Send_to}:" style="height: auto; width: 500px;">
		    	<input type="radio" class='radio' name='radio' value='1' checked="checked"/><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Recipients_who_have_recieved}."/><br/>
		    	<input type="radio" class='radio' name='radio' value='2'/><div id="radio2"><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Recipients_who_have_not}."/></div>
		    	<input type="radio" class='radio' name='radio' value='3'/><div id="radio3"><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_all_recipients}."/></div>
		    	<div id="CportalDiv"></div>
		    	<button id="cancelButton" class="leftContainer surveyButton" onClick="sendEmailsOverlayDijit.hide();"><img alt="{!$Label.timbasurvey_surveylist_cancel}" src="{!URLFOR($Resource.SurveyResources2,'img/overlay/cancelicon.png')}"/>{!$Label.timbasurvey_surveylist_cancel}</button>
				<button id="doneButton" class="leftContainer surveyButton" onClick="sendEmailController();" ><img alt="{!$Label.timbasurvey_surveyCollect_Send}" src="{!URLFOR($Resource.SurveyResources2,'img/collector/mail_send.png')}"/>{!$Label.timbasurvey_surveyCollect_Send}</button>
		    </div>

			<form id='textAreaIdSend' style="display:none;">
				<textarea id='pE' name='pE' cols="300"></textarea>
				<textarea id='cIds' name='cIds' cols="300"></textarea>
				<textarea id='LIds' name='LIds' cols="300"></textarea>
				<textarea id='uIds' name='uIds' cols="300"></textarea>
				<input id='isAnonymous' name='isAnonymous' type="text" />
				<input id='send_to_all' name='send_to_all' type="text" value='false'/>
				<input id='toc' name='toc' type="text"/>
			</form>

			<div jsId="progresSendEmailsDijit" id="progresSendEmails" dojoType="dijit.Dialog"  color="white" title="{!$Label.timbasurvey_Collect_Sending_Email}" style="height: 180px; width:247px;" >
				<div id='titleSend'><apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Sending}..."/></div>
				<div id='progresBar'>
					<img alt="{!$Label.timbasurveys_surveycollect_Sending}" src="{!URLFOR($Resource.SurveyResources2,'img/collector/sendEmailProgres.gif')}"/>
					<div id='bar'></div>
				</div>
				<div id='dataProgres'>
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Loading}" />
				</div>
			</div>

			<div jsId="emailTemplateErrorDijit" id="emailTemplateError" dojoType="dijit.Dialog"  color="white" title="Config Email" onCancel="return false;">
				<div id="email_template_missing_message" class='email_template_missing_message'  style="display:{!IF(!existEmailTemplate,'','none')}"><img src="{!URLFOR($Resource.SurveyResources, 'imgs/icons/block_64.png')}" />
					<br />
					<br />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_The_email_template}." /> <br />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Please_reset_your}." />
					<br />
					<button id="recreate" class="surveyButton" 	onClick="mesageErrorTemplate(1);">{!$Label.timbasurveys_surveycollect_Reset_Email_Template}</button>
				</div>

				<div id="email_template_broken_message" class='email_template_missing_message' style="display:{!IF(emailtemplateBroken,'','none')}"><img src="{!URLFOR($Resource.SurveyResources, 'imgs/icons/block_64.png')}" />
					<br />
					<br />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_An_error_occurred}." /><br />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Please_reset_your}." />
					<br />
					<button id="reset" class="surveyButton" onClick="mesageErrorTemplate(2);">{!$Label.timbasurveys_surveycollect_Reset_Email_Template}</button>
				</div>
				
				<div dojoType="dijit.Dialog" id="StartDateGrater" jsId="StartDateGraterDialog" title="{!$Label.timbasurvey_surveyBrowser_Select_Dates}">
    				<apex:outputText value="{!$Label.timbasurveys__timbasurvey_surveyBrowser_Expiration_Date_Lower_Today}." />
    			</div>

				<div id="portal_email_template_broken_message" class='email_template_missing_message' style="display:{!IF(fixCpBody,'','none')} ">
					<img src="{!URLFOR($Resource.SurveyResources, 'imgs/icons/block_64.png')}" />
					<br />
					<br />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_The_customer}."/><br />
					<apex:outputText value="{!$Label.timbasurveys__timbasurveys_surveycollect_Please_reset_your}." />
					<br />
					<button id="cp_reset" class="surveyButton" onClick="mesageErrorTemplate(3);">{!$Label.timbasurveys_surveycollect_Reset_Email_Template}</button>
				</div>
		</div>

  		<div jsId="errorLeadContactDijit" id="errorEmailLeadContact" dojoType="dijit.Dialog" class="ErrorCollect" color="white" title="Email not valid" onCancel="clearErrorEmailLeadContact();" >
  				<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_one_or_more}" /> <br />
  				<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_bounced_emails}" /> <br />
  				<apex:outputLabel value="{!$Label.timbasurveys__timbasurveys_surveycollect_please_update}." /><br/><br/>
				<div id='errorLeadContactDiv'><table id='tableEmailErrorLeadContact'></table></div>
				<a id='errorEmailsButton' href="javascript:;" onclick="clearErrorEmailLeadContact();">
					<apex:outputText styleClass="addRecipientsText" value="{!$Label.timbasurveys__timbasurveys_surveycollect_Clear}" />
				</a>
  		</div>
  		</apex:define>
	</apex:composition>
</apex:page>